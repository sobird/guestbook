# sample
server {
  listen 80;
  listen [::]:80;

  # SSL configuration
  #
  listen 443 ssl http2;
  listen [::]:443 ssl http2;

  # Self signed certs generated by the ssl-cert package
  # Don't use them in a production server!
  #
  include snippets/snakeoil.conf;

  # Add index.php to the list if you are using PHP
  # index index.html index.htm index.nginx-debian.html;

  server_name guestbook.sobird.me;
  
  location / {
    # First attempt to serve request as file, then
    # as directory, then fall back to displaying a 404.
    # try_files $uri $uri/ =404;
    #proxy_set_header X-Real-IP $remote_addr;
    #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    #proxy_set_header Host $http_host;
    #proxy_set_header X-Nginx-Proxy true;
    #proxy_set_header Connection "";
    proxy_pass http://nextjs;
  }

  location /_next/static/ {
    alias /home/nextjs/static;
  }

  location /favicon.ico {
    alias /home/nextjs/static/favicon.ico;
  }

  location /api/ {
		proxy_pass http://api;
	}
  
  # cache
  location ~ .*\.(js|css|gif|jpg|jpeg|png|bmp|swf)$ {
    expires 30d;
  }
}

